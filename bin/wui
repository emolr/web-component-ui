#!/usr/bin/env node
const process = require('process');
const program = require('commander');
const runner = require('../runner');
const path = require('path');

const cwd = process.cwd();
const gulp = runner.gulp.run({directory: cwd})

program
    .version('0.0.1')
    .option('-w, --watch', 'keep watching for changes')
    .option('-s, --serve', 'serve documentation')
    .option('-c, --compile', 'compile and bundle typescript')
    .option('-d, --documentation', 'generate documentation')
    .parse(process.argv);

if (!program.watch && program.compile) {
    gulp.compile(program).then(() => {
        console.log('Compile done')

        if (program.serve) {
            runner.bs.init(cwd);
        }
        
    }).catch(err => {
        console.log(err)
    });
} else if (program.watch){
    gulp.watch(program).then(() => {
        if (program.serve) {
            runner.bs.init(cwd);
        }
    }).catch(err => {
        console.log(err)
    });
} else {
    console.log('No options where defined, see --help for more options')
    process.exit(0)
}
